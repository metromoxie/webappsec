<!doctype html>
<html lang="en">
  <head>
  
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    
  
    <title>Suborigins</title>
    
  
    <link href="../default.css" rel="stylesheet" type="text/css">
    
  
    <style>
  body {
    background: url("https://www.w3.org/StyleSheets/TR/logo-ED") top left no-repeat white;
    background-attachment: fixed;
    color: black;
    font-family: sans-serif;
    margin: 0 auto;
    max-width: 50em;
    padding: 2em 1em 2em 70px;
  }
  :link { color: #00C; background: transparent }
  :visited { color: #609; background: transparent }
  a[href]:active { color: #C00; background: transparent }
  a[href]:hover { background: #ffa }

  a[href] img { border-style: none }

  h1, h2, h3, h4, h5, h6 { text-align: left }
  h1, h2, h3 { color: #005A9C; }
  h1 { font: 170% sans-serif }
  h2 { font: 140% sans-serif }
  h3 { font: 120% sans-serif }
  h4 { font: bold 100% sans-serif }
  h5 { font: italic 100% sans-serif }
  h6 { font: small-caps 100% sans-serif }

  .hide { display: none }

  div.head { margin-bottom: 1em }
  div.head h1 { margin-top: 2em; clear: both }
  div.head table { margin-left: 2em; margin-top: 2em }

  p.copyright { font-size: small }
  p.copyright small { font-size: small }

  pre { margin-left: 2em }
  dt { font-weight: bold }

  ul.toc, ol.toc {
    list-style: none;
  }
  </style>
    

  </head>
  

  <body class="h-entry">

    <div class="head">
  
      <p data-fill-with="logo"><a class="logo" href="http://www.w3.org/">
    <img alt="W3C" height="48" src="https://www.w3.org/Icons/w3c_home" width="72">
</a>
</p>
  
      <h1 class="p-name no-ref" id="title">Suborigins</h1>
  
      <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Editor’s Draft,
    <time class="dt-updated" datetime="2015-01-09">9 January 2015</time></span></h2>
  
      <div data-fill-with="spec-metadata">
        <dl>
          <dt>This version:</dt>
          <dd><a class="u-url" href="https://w3c.github.io/webappsec/specs/suborigins/">https://w3c.github.io/webappsec/specs/suborigins/</a></dd>
          <dt>Feedback:</dt>
          <dd><span><a href="mailto:public-webappsec@w3.org?subject=%5Bsuborigins%5D%20feedback">public-webappsec@w3.org</a> with subject line “<kbd>[suborigins] <var>… message topic …</var></kbd>” (<a href="http://lists.w3.org/Archives/Public/public-webappsec/" rel="discussion">archives</a>)</span></dd>
          <dt>Issue Tracking:</dt>
          <dd><a href="#issues-index">Inline In Spec</a></dd>
          <dt class="editor">Editor:</dt>
          <dd class="editor">
            <div class="p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:Inc. jww@google.com">Joel Weinberger Google</a></div>
          </dd>
        </dl>
      </div>
  
      <div data-fill-with="warning"></div>
  
      <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2014
  <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup>
  (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
  <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
  <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>),

  All Rights Reserved.

  <abbr title="World Wide Web Consortium">W3C</abbr> <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
  <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and

  <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a>
  rules apply.
</p>
  
      <hr title="Separator for header">
</div>


    <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>

    <div class="p-summary" data-fill-with="abstract">
      <p>This specification defines a mechanism by which a server may specify a web resource response a new origin in the user agent which is a combination of the server’s origin and a specified namespace.</p>

</div>


    <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>

    <div data-fill-with="status">
      <p>
	This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress.

</p>
      <p>
  <strong>Changes to this document may be tracked at
  <a href="https://github.com/w3c/webappsec">https://github.com/w3c/webappsec</a>.</strong>

</p>
      <p>
	The (<a href="http://lists.w3.org/Archives/Public/public-webappsec/">archived</a>) public mailing list
	<a href="mailto:public-webappsec@w3.org?Subject=%5Bsuborigins%5D%20PUT%20SUBJECT%20HERE">public-webappsec@w3.org</a>
	(see <a href="http://www.w3.org/Mail/Request">instructions</a>)
	is preferred for discussion of this specification.
	When sending e-mail,
	please put the text “suborigins” in the subject,
	preferably like this:
	“[suborigins] <em>…summary of comment…</em>”

</p>
      <p>
	This document was produced by the
  <a href="http://www.w3.org/2011/webappsec/">Web Application Security Working Group</a>.

</p>
      <p>
	This document was produced by a group operating under
	the <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent Policy</a>.
	W3C maintains a <a href="http://www.w3.org/2004/01/pp-impl/49309/status" rel="disclosure">public list of any patent disclosures</a>
	made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent which the individual believes contains <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a>
	must disclose the information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the W3C Patent Policy</a>.

</p>
      <p>
  This document is governed by the <a href="http://www.w3.org/2014/Process-20140801/" id="w3c_process_revision">1 August 2014 W3C Process Document</a>.

</p></div>

    <div data-fill-with="at-risk"></div>


    <h2 class="no-num no-toc no-ref heading settled" id="contents"><span class="content">Table of Contents</span></h2>

    <div data-fill-with="table-of-contents" role="navigation">
      <ul class="toc" role="directory">
        <li><a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
          <ul class="toc">
            <li><a href="#goals"><span class="secno">1.1</span> <span class="content">Goals</span></a></li>
            <li><a href="#usecases"><span class="secno">1.2</span> <span class="content">Use Cases/Examples</span></a></li>
          </ul>
        </li>
        <li><a href="#terms"><span class="secno">2</span> <span class="content">Key Concepts and Terminology</span></a>
          <ul class="toc">
            <li><a href="#terms-defined-here"><span class="secno">2.1</span> <span class="content">Terms defined by this specification</span></a></li>
            <li><a href="#terms-defined-by-reference"><span class="secno">2.2</span> <span class="content">Terms defined by reference</span></a></li>
          </ul>
        </li>
        <li><a href="#conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
          <ul class="toc">
            <li><a href="#conventions"><span class="secno"></span> <span class="content">Document conventions</span></a></li>
            <li><a href="#conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a></li>
            <li><a href="#conformance-classes"><span class="secno"></span> <span class="content">Conformance Classes</span></a></li>
          </ul>
        </li>
        <li><a href="#references"><span class="secno"></span> <span class="content">References</span></a>
          <ul class="toc">
            <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a></li>
          </ul>
        </li>
        <li><a href="#index"><span class="secno"></span> <span class="content">Index</span></a></li>
        <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a></li>
      </ul></div>

    <main>




      <section>

        <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>


        <p><em>This section is not normative.</em></p>


        <p>Currently, web applications are almost always compartmentalized by using
separate host names to establish separate web origins. This is useful for
helping to prevent XSS and other cross-origin attacks, but has many unintended
consequences. For example, it causes latency due to additional DNS lookups,
removes the ability to use single-origin features (such as the
history.pushState API), and creates cryptic host name changes in the user
experience. Perhaps most importantly, it results in an extremely inflexible
architecture that, once rolled out, cannot be easily and transparently changed
later on.</p>


        <p>There are several mechanisms for reducing the attack surface for XSS without
creating separate host-name based origins, but each pose their own problems.
Per-page Suborigins is an attempt to fill some of those gaps. Two of the most
notable mechanisms are Sandboxed Frames and Content Security Policy (CSP). Both
are powerful but have shortcomings and there are many external developers
building legacy applications that find they cannot use those tools.</p>


        <p>Sandboxed frames can be used to completely separate untrusted content, but they
pose a large problem for containing trusted but potentially buggy code because
it is very difficult, by design, for them to communicate with other frames. The
synthetic origins assigned in a sandboxed frame are random and unpredictable,
making the use of postMessage and CORS difficult. Moreover, because they are by
definition unique origins, with no relationship to the original origin,
designing permissions for them to access resources of the original origin would
be difficult.</p>


        <p>Content Security Policy is also promising but is generally incompatible with
current website design. Many notable companies found it impractical to retrofit
most of their applications with it. On top of this, until all applications
hosted within a single origin are simultaneously put behind CSP, the mechanism
offers limited incremental benefits, which is especially problematic for
companies with large portfolios of disparate products all under the same domain.</p>


        <h3 class="heading settled" data-level="1.1" id="goals"><span class="secno">1.1. </span><span class="content">Goals</span><a class="self-link" href="#goals"></a></h3>


        <ol>
  
          <li>
    Provide a way for different applications hosted at the same real origin to
    separate their content into separate logical origins. For example,
    https://foobar.com/application and https://foobar.com/widget, today, are, by
    definition, in the same origin, even if they’re different applications. Thus
    an XSS at https://foobar.com/application means an XSS at
    https://foobar.com/widget, even if https://foobar.com/widget is "protected"
    by a strong Content Security Policy.
  </li>

  
          <li>
    Similarly, provide a way for content authors to split their applications
    into logical modules with origin level separation without using different
    real origins. Content authors should not have to choose between putting all
    of their content in the same origin, on different real origins, or putting
    content in anonymous unique origins (sandboxes).
  </li>

  
          <li>
    Provide a way for content authors to attribute different permissions such as
    cookie access, storage access, etc. to different suborigins.
  </li>

</ol>


        <p class="issue" id="issue-e1a79dec"><a class="self-link" href="#issue-e1a79dec"></a>Not sure how to actually refer to 'real origins'. This is a terrible
name, and we need a better way to talk about them. Maybe physical origin?
Traditional origin? (jww)</p>


        <h3 class="heading settled" data-level="1.2" id="usecases"><span class="secno">1.2. </span><span class="content">Use Cases/Examples</span><a class="self-link" href="#usecases"></a></h3>


        <p>We see effectively three different use cases for Per-page Suborigins:</p>


        <ol>
  
          <li>
    Separating distinct applications that happen to be served from the same
    domain, but do not need to extensively interact with other content. Examples
    include marketing campaigns, simple search UIs, and so on. This use requires
    very little engineering effort and faces very few constraints; the
    applications may use XMLHttpRequest and postMessage to communicate with
    their host domain as required.
  </li>

  
          <li>
    Allowing for modularity within a larger web application by splitting the
    functional components into different suborigins. For example, Gmail might
    put the contacts widget, settings tab, and HTML message views in separate
    Per-page Suborigins. Such deployments may require relatively modest
    refactorings to switch to postMessage and CORS where direct DOM access and
    same-origin XMLHttpRequest are currently used, but we believe doing so is
    considerably easier than retrofitting CSP onto arbitrary code bases and can
    be done very incrementally.
  </li>

  
          <li>
    Similar to (2), applications with many users can split information relating
    to different users into their own suborigin. For example, Twitter might put
    each user profile into a unique suborigin so that an XSS within one profile
    cannot be used to immediately infect other users or read their personal
    messages stored within the account.
  </li>

</ol>

</section>


      <section>

        <h2 class="heading settled" data-level="2" id="terms"><span class="secno">2. </span><span class="content">Key Concepts and Terminology</span><a class="self-link" href="#terms"></a></h2>
This section defines several terms used throughout the document.


        <h3 class="heading settled" data-level="2.1" id="terms-defined-here"><span class="secno">2.1. </span><span class="content">Terms defined by this specification</span><a class="self-link" href="#terms-defined-here"></a></h3>


        <h3 class="heading settled" data-level="2.2" id="terms-defined-by-reference"><span class="secno">2.2. </span><span class="content">Terms defined by reference</span><a class="self-link" href="#terms-defined-by-reference"></a></h3>

        <dl>
    
          <dt><dfn data-dfn-type="dfn" data-noexport="" id="origin">origin<a class="self-link" href="#origin"></a></dfn></dt>
    
          <dd>
      An origin defines the scope of authority or privilege under which a
      resource operates. It is defined in detail in the Origin specification
      <a data-biblio-type="normative" data-link-type="biblio" href="#biblio-rfc6454" title="RFC6454">[RFC6454]</a>.
    </dd>
</dl>

</section>


</main>

    <h2 class="no-ref no-num heading settled" id="conformance"><span class="content">Conformance</span><a class="self-link" href="#conformance"></a></h2>


    <h3 class="no-ref no-num heading settled" id="conventions"><span class="content">Document conventions</span><a class="self-link" href="#conventions"></a></h3>

    
    <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words "MUST",
    "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
    "RECOMMENDED", "MAY", and "OPTIONAL" in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification.

    </p>
    <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-biblio-type="normative" data-link-type="biblio" href="#biblio-rfc2119" title="RFC2119">[RFC2119]</a></p>

    
    <p>Examples in this specification are introduced with the words "for example"
    or are set apart from the normative text with <code>class="example"</code>,
    like this:

    </p>
    <div class="example">
        
      <p>This is an example of an informative example.</p>
      
    
    </div>

    
    <p>Informative notes begin with the word "Note" and are set apart from the
    normative text with <code>class="note"</code>, like this:

    </p>
    <p class="note" role="note">Note, this is an informative note.</p>


    <h3 class="no-ref no-num heading settled" id="conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#conformant-algorithms"></a></h3>

    
    <p>Requirements phrased in the imperative as part of algorithms (such as
    "strip any leading space characters" or "return false and abort these
    steps") are to be interpreted with the meaning of the key word ("must",
    "should", "may", etc) used in introducing the algorithm.</p>

    
    <p>Conformance requirements phrased as algorithms or specific steps can be
    implemented in any manner, so long as the end result is equivalent. In
    particular, the algorithms defined in this specification are intended to
    be easy to understand and are not intended to be performant. Implementers
    are encouraged to optimize.</p>


    <h3 class="no-ref no-num heading settled" id="conformance-classes"><span class="content">Conformance Classes</span><a class="self-link" href="#conformance-classes"></a></h3>

    
    <p>A <dfn data-dfn-type="dfn" data-noexport="" id="conformant-user-agent">conformant user agent<a class="self-link" href="#conformant-user-agent"></a></dfn> must implement all the requirements
    listed in this specification that are applicable to user agents.</p>

    
    <p>A <dfn data-dfn-type="dfn" data-noexport="" id="conformant-server">conformant server<a class="self-link" href="#conformant-server"></a></dfn> must implement all the requirements listed
    in this specification that are applicable to servers.</p>




    <h2 class="no-num heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
    <h3 class="no-num heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
    <dl>
      <dt id="biblio-rfc2119" title="rfc2119"><a class="self-link" href="#biblio-rfc2119"></a>[rfc2119]</dt>
      <dd>S. Bradner. <a href="http://www.ietf.org/rfc/rfc2119.txt">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="http://www.ietf.org/rfc/rfc2119.txt">http://www.ietf.org/rfc/rfc2119.txt</a></dd>
      <dt id="biblio-rfc6454" title="rfc6454"><a class="self-link" href="#biblio-rfc6454"></a>[rfc6454]</dt>
      <dd>A. Barth. <a href="http://www.ietf.org/rfc/rfc6454.txt">The Web Origin Concept</a>. December 2011. Proposed Standard. URL: <a href="http://www.ietf.org/rfc/rfc6454.txt">http://www.ietf.org/rfc/rfc6454.txt</a></dd></dl>
    <h2 class="no-num heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
    <ul class="indexlist">
      <li>conformant server, <a href="#conformant-server" title="section Unnumbered section">Unnumbered section</a></li>
      <li>conformant user agent, <a href="#conformant-user-agent" title="section Unnumbered section">Unnumbered section</a></li>
      <li>origin, <a href="#origin" title="section 2.2">2.2</a></li></ul>
    <h2 class="no-num heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
    <div style="counter-reset:issue">
      <div class="issue">Not sure how to actually refer to 'real origins'. This is a terrible
name, and we need a better way to talk about them. Maybe physical origin?
Traditional origin? (jww)<a href="#issue-e1a79dec"> ↵ </a></div></div></body>
</html>